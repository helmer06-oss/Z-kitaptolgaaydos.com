<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Z-Kitap: Auto & Responsive | Tolga Aydos</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* --- RENK PALETİ --- */
            --bg-dark: #0f1115;
            --panel-bg: #161b22;
            --neon-cyan: #00f2ff;
            --neon-green: #00e676;
            --neon-red: #ff3b30;
            --brand-orange: #ff9f43;
            --text-gray: #7f8c8d;
            --border-line: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: white;
            height: 100vh; height: 100dvh;
            display: flex; flex-direction: column;
            overflow: hidden; user-select: none;
        }

        /* HEADER */
        header {
            height: 60px;
            background: var(--panel-bg);
            border-bottom: 1px solid var(--border-line);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
            z-index: 50; flex-shrink: 0;
        }
        .logo {
            font-family: 'Orbitron', sans-serif; font-weight: 700; font-size: 1rem;
            color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 60%;
        }
        .logo span { color: var(--brand-orange); } 
        .logo .desc { font-weight: 400; color: #ccc; font-size: 0.8em; margin-left: 5px; }

        .toolbar { display: flex; gap: 5px; }
        .toolbar button {
            background: rgba(255,255,255,0.05); border: 1px solid var(--border-line);
            color: #ccc; width: 38px; height: 38px; border-radius: 6px;
            cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center;
        }
        .toolbar button.active-tool {
            background: var(--brand-orange); color: #000; border-color: var(--brand-orange);
        }

        /* ANA KONTEYNER */
        .main-container {
            display: flex; flex: 1; padding: 20px; gap: 20px;
            height: calc(100vh - 60px); 
            overflow: hidden; 
        }

        /* --- SOL MENÜ --- */
        .sidebar {
            width: 75px;
            height: 100%; 
            display: flex; flex-direction: column; gap: 10px;
            overflow-y: auto; padding-right: 5px; flex-shrink: 0;
            padding-bottom: 50px;
        }
        .sidebar::-webkit-scrollbar { width: 5px; }
        .sidebar::-webkit-scrollbar-track { background: #161b22; border-radius: 3px; }
        .sidebar::-webkit-scrollbar-thumb { background: var(--brand-orange); border-radius: 3px; }

        .q-nav-btn {
            width: 55px; height: 55px;
            margin: 0 auto;
            background: #1e222b; border: 1px solid var(--border-line);
            border-radius: 12px; color: var(--text-gray);
            font-family: 'Orbitron', sans-serif; font-weight: 600; font-size: 1.1rem;
            cursor: pointer; flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
            transition: 0.2s;
        }
        .q-nav-btn.active {
            background: var(--brand-orange); color: #000;
            border-color: var(--brand-orange); transform: scale(1.05);
            box-shadow: 0 0 12px rgba(255, 159, 67, 0.4);
        }

        /* ORTA ALAN */
        .stage-wrapper {
            flex: 1; background: #fff; border-radius: 15px;
            position: relative; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.5); overflow: hidden;
        }
        .image-container { position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        .image-container img { max-width: 100%; max-height: 100%; object-fit: contain; z-index: 1; }
        #draw-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }
        
        .nav-arrow {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 45px; height: 45px; border-radius: 50%;
            background: rgba(240, 240, 240, 0.9); border: 1px solid #ccc;
            color: #333; font-size: 1.4rem; cursor: pointer; z-index: 10;
            display: flex; align-items: center; justify-content: center;
        }
        .prev { left: 15px; } .next { right: 15px; }

        /* --- SAĞ PANEL --- */
        .right-panel {
            width: 320px;
            background: var(--panel-bg); border-radius: 20px;
            padding: 20px;
            display: flex; flex-direction: column;
            justify-content: space-between;
            box-shadow: -5px 0 20px rgba(0,0,0,0.2); flex-shrink: 0;
            overflow: hidden; 
        }
        .panel-header { text-align: center; margin-bottom: 10px; flex-shrink: 0; }
        .panel-header h2 {
            font-family: 'Orbitron', sans-serif; color: var(--neon-cyan); margin: 0; font-size: 1.8rem;
        }
        .counter { font-size: 0.9rem; color: #aaa; margin-left: 10px; background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 6px; }
        
        /* ŞIKLAR (Esnek Grid) */
        .options-grid { 
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 12px;
            flex: 1;
            margin: 15px 0;
            min-height: 0;
        }
        
        .option-btn {
            width: 100%; height: 100%;
            background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.15);
            border-radius: 12px; color: #eee; font-family: 'Orbitron', sans-serif; 
            font-size: 2.2rem;
            cursor: pointer; transition: 0.2s;
            display: flex; align-items: center; justify-content: center;
        }
        .option-btn:hover { background: rgba(255,255,255,0.06); }
        .option-btn.correct { border-color: var(--neon-green); color: var(--neon-green); background: rgba(0, 230, 118, 0.1); box-shadow: 0 0 15px rgba(0, 230, 118, 0.3); }
        .option-btn.wrong { border-color: var(--neon-red); color: var(--neon-red); background: rgba(255, 59, 48, 0.1); box-shadow: 0 0 15px rgba(255, 59, 48, 0.3); }
        
        .signature { text-align: center; font-size: 0.75rem; color: #666; flex-shrink: 0; }
        .signature b { color: var(--brand-orange); } 

        /* ========================================= */
        /* MOBİL DÜZELTME (FIX)                      */
        /* ========================================= */
        @media (max-width: 900px) {
            body {
                overflow: auto; /* Sayfanın kendisi kayabilsin */
                height: auto;
                min-height: 100vh;
            }
            .main-container { 
                flex-direction: column; 
                padding: 10px; 
                height: auto; 
                overflow: visible; /* İçerik taşarsa göster */
                display: flex;
            }
            
            .sidebar { 
                width: 100%; height: 70px; flex-direction: row; 
                overflow-x: auto; overflow-y: hidden;
                padding: 5px 10px; border-bottom: 1px solid rgba(255,255,255,0.1);
                position: sticky; top: 0; background: var(--bg-dark); z-index: 20;
                margin-bottom: 10px; gap: 10px;
                flex-shrink: 0;
            }
            .q-nav-btn { width: 50px; height: 50px; margin: 0; font-size: 1rem; }

            .stage-wrapper { 
                height: 40vh; 
                min-height: 250px; 
                border-radius: 15px; 
                margin-bottom: 15px; 
                flex-shrink: 0;
            }
            
            .right-panel { 
                width: 100%; 
                height: auto; 
                padding-bottom: 30px; 
                flex-shrink: 0;
            }
            
            .options-grid { 
                /* Mobilde butonlar ezilmesin, belirli bir boyutu korusun */
                height: 220px; 
                flex: none; /* Esnemeyi kapat, yüksekliği koru */
            } 
            .option-btn { font-size: 1.8rem; }
            .logo .desc { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">tolga<span>aydos</span>.com <span class="desc">Fen Bilimleri Platformu</span></div>
        <div class="toolbar">
            <button id="btn-draw" onclick="toggleDrawing()" title="Kalem">✎</button>
            <button id="btn-erase" onclick="clearCanvas()" title="Temizle">⌫</button>
            <button onclick="toggleFS()" title="Tam Ekran">⛶</button>
        </div>
    </header>

    <div class="main-container">
        
        <div class="sidebar" id="sidebar">
            <div style="color:#666; font-size:0.8rem; padding:10px; text-align:center;">Aranıyor...</div>
        </div>

        <div class="stage-wrapper" id="stage">
            <button class="nav-arrow prev" onclick="changeQ(-1)">❮</button>
            <div class="image-container">
                <img id="q-img" src="" alt="Soru">
                <canvas id="draw-canvas"></canvas>
            </div>
            <button class="nav-arrow next" onclick="changeQ(1)">❯</button>
        </div>

        <div class="right-panel">
            <div class="panel-header">
                <h2>SORU <span id="q-idx">--</span> <span class="counter" id="q-total">/ --</span></h2>
            </div>
            
            <div class="options-grid">
                <button class="option-btn" onclick="check(this, 'A')">A</button>
                <button class="option-btn" onclick="check(this, 'B')">B</button>
                <button class="option-btn" onclick="check(this, 'C')">C</button>
                <button class="option-btn" onclick="check(this, 'D')">D</button>
            </div>
            
            <div class="signature">Designed by <b>tolgaaydos.com</b></div>
        </div>
    </div>

    <script>
        // ============================================
        // OTOMATİK SORU LİSTESİ (BOŞ BAŞLAR)
        // ============================================
        let questions = [];
        let current = 0;
        
        // --- ÇİZİM DEĞİŞKENLERİ ---
        let isDrawingMode = false;
        let isDrawing = false;
        const canvas = document.getElementById('draw-canvas');
        const ctx = canvas.getContext('2d');
        let lastX = 0, lastY = 0;

        // ============================================
        // OTOMATİK DOSYA TARAMA (AUTO-DETECT)
        // ============================================
        async function detectQuestions() {
            const tempQuestions = [];
            const suffixes = ['A', 'B', 'C', 'D'];
            let qNumber = 1;
            let found = true;

            // Maksimum 50 soruya kadar tarar, bulunamazsa durur.
            while (found && qNumber <= 50) {
                found = false;
                // Her soru numarası için A, B, C, D'yi dene
                for (let char of suffixes) {
                    const fileName = `${qNumber}${char}.jpg`;
                    const exists = await imageExists(fileName);
                    
                    if (exists) {
                        tempQuestions.push(fileName);
                        found = true;
                        break; // Bu numarayı bulduk, diğer harfleri denemeye gerek yok (1A bulduysak 1B'ye bakma, direk 2'ye geç)
                    }
                }
                
                // Eğer bu turda (mesela 4. soruda) hiçbir harf bulunamadıysa döngü biter.
                if (found) {
                    qNumber++;
                }
            }
            
            questions = tempQuestions;
            finishInit();
        }

        function imageExists(url) {
            return new Promise(resolve => {
                const img = new Image();
                img.onload = () => resolve(true);
                img.onerror = () => resolve(false);
                img.src = url;
            });
        }

        function finishInit() {
            if (questions.length === 0) {
                document.getElementById('sidebar').innerHTML = '<div style="color:white; padding:10px; font-size:0.8rem">Soru Bulunamadı.<br>Dosya adlarını kontrol et: 1A.jpg, 2B.jpg...</div>';
                document.getElementById('q-idx').innerText = "00";
                document.getElementById('q-total').innerText = "/ 0";
                return;
            }

            renderSidebar();
            document.getElementById('q-total').innerText = "/ " + questions.length;
            load(0);
        }

        function init() {
            setupCanvas();
            window.addEventListener('resize', resizeCanvas);
            detectQuestions(); // Taramayı başlat
        }

        function renderSidebar() {
            const sb = document.getElementById('sidebar');
            sb.innerHTML = '';
            questions.forEach((_, i) => {
                const btn = document.createElement('button');
                btn.className = 'q-nav-btn';
                btn.textContent = i + 1;
                btn.onclick = () => load(i);
                sb.appendChild(btn);
            });
        }

        function load(idx) {
            if(idx < 0 || idx >= questions.length) return;
            current = idx;
            clearCanvas();

            const img = document.getElementById('q-img');
            img.style.opacity = 0;
            
            setTimeout(() => {
                img.src = questions[idx];
                document.getElementById('q-idx').innerText = (idx + 1).toString().padStart(2, '0');
                
                const btns = document.querySelectorAll('.q-nav-btn');
                btns.forEach((b, i) => {
                    const isActive = i === idx;
                    b.classList.toggle('active', isActive);
                    if(isActive) b.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                });

                resetBtns();
                img.onload = () => { img.style.opacity = 1; resizeCanvas(); };
            }, 100);
        }

        function changeQ(dir) { load(current + dir); }

        // --- ÇİZİM FONKSİYONLARI ---
        function setupCanvas() {
            canvas.addEventListener('mousedown', startD);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopD);
            canvas.addEventListener('mouseout', stopD);
            canvas.addEventListener('touchstart', (e) => {
                const t = e.touches[0];
                canvas.dispatchEvent(new MouseEvent('mousedown', { clientX: t.clientX, clientY: t.clientY }));
            });
            canvas.addEventListener('touchmove', (e) => {
                const t = e.touches[0];
                canvas.dispatchEvent(new MouseEvent('mousemove', { clientX: t.clientX, clientY: t.clientY }));
            });
            canvas.addEventListener('touchend', () => canvas.dispatchEvent(new MouseEvent('mouseup', {})));
            resizeCanvas();
        }

        function resizeCanvas() {
            const container = document.querySelector('.image-container');
            if(container) {
                canvas.width = container.offsetWidth;
                canvas.height = container.offsetHeight;
                ctx.lineJoin = 'round'; ctx.lineCap = 'round'; ctx.lineWidth = 3; ctx.strokeStyle = '#e74c3c';
            }
        }

        function toggleDrawing() {
            isDrawingMode = !isDrawingMode;
            const btn = document.getElementById('btn-draw');
            const stage = document.getElementById('stage');
            if(isDrawingMode) {
                btn.classList.add('active-tool');
                canvas.style.pointerEvents = 'auto';
                stage.style.cursor = 'crosshair';
            } else {
                btn.classList.remove('active-tool');
                canvas.style.pointerEvents = 'none';
                stage.style.cursor = 'default';
            }
        }

        function startD(e) {
            if(!isDrawingMode) return;
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            lastX = e.clientX - rect.left;
            lastY = e.clientY - rect.top;
        }

        function draw(e) {
            if(!isDrawing || !isDrawingMode) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            ctx.beginPath(); ctx.moveTo(lastX, lastY); ctx.lineTo(x, y); ctx.stroke();
            [lastX, lastY] = [x, y];
        }

        function stopD() { isDrawing = false; }
        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

        // --- CEVAP KONTROLÜ ---
        function resetBtns() {
            document.querySelectorAll('.option-btn').forEach(b => {
                b.className = 'option-btn'; b.style.pointerEvents = 'auto';
            });
        }

        function check(btn, choice) {
            const fileName = questions[current];
            const match = fileName.match(/(\d+)([A-D])/i);
            if(!match) return;
            const correct = match[2].toUpperCase();
            document.querySelectorAll('.option-btn').forEach(b => b.style.pointerEvents = 'none');
            if(choice === correct) btn.classList.add('correct');
            else {
                btn.classList.add('wrong');
                document.querySelectorAll('.option-btn').forEach(b => {
                    if(b.textContent === correct) b.classList.add('correct');
                });
            }
        }

        function toggleFS() {
            if(!document.fullscreenElement) document.documentElement.requestFullscreen();
            else if(document.exitFullscreen) document.exitFullscreen();
        }

        init();
    </script>
</body>
</html>
